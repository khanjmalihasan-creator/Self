#!/usr/bin/env python3
# Ø³Ù„Ù Ø¨Ø§Øª Ø³Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ GitHub
import os
import requests
import time
import random
from datetime import datetime

# ØªÙˆÚ©Ù† Ø±Ø¨Ø§Øª ØªÙˆ
TOKEN = "8427517390:AAGGGepVprNmhjEBibZnewxOOuWKHv_ojNE"

print("ğŸ¤– Ø³Ù„Ù Ø¨Ø§Øª ÙØ§Ø±Ø³ÛŒ ÙØ¹Ø§Ù„ Ø´Ø¯!")

# Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ
enemy_id = None
enemy_name = None
enemy_mode = False

# Ù„ÛŒØ³Øª ÙØ­Ø´â€ŒÙ‡Ø§ÛŒ Ø±Ú©ÛŒÚ©
BAD_WORDS = [
    "Ú©Øµ Ù†Ù†Øª", "Ú©ÛŒØ±Ù… Ø¯Ù‡Ù†Øª", "Ø¬Ù†Ø¯Ù‡", "Ú©ÙˆÙ†ÛŒ", "Ù„Ø§Ø´ÛŒ",
    "Ú©Øµ Ú©Ø´", "Ø­Ø±ÙˆÙ… Ø²Ø§Ø¯Ù‡", "Ú¯Ø§ÛŒÛŒØ¯Ù…Øª", "Ù†Ù†Ù‡ Ø¬Ù†Ø¯Ù‡",
    "Ú©Øµ Ø®Ù„", "Ø®Ø§Ø±Ú©ØµÙ‡", "ØªØ®Ù… Ø³Ú¯", "Ø¨ÛŒ Ù†Ø§Ù…ÙˆØ³"
]

def send_message(chat_id, text, reply_to=None):
    """Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø§Ø² Ø·Ø±ÛŒÙ‚ Ø±Ø¨Ø§Øª"""
    try:
        url = f"https://api.telegram.org/bot{TOKEN}/sendMessage"
        data = {
            'chat_id': chat_id,
            'text': text,
            'parse_mode': 'HTML'
        }
        if reply_to:
            data['reply_to_message_id'] = reply_to
        
        response = requests.post(url, data=data, timeout=10)
        return response.json()
    except Exception as e:
        print(f"âš ï¸ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…: {e}")
        return None

def process_update(update):
    """Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¢Ù¾Ø¯ÛŒØª Ø¯Ø±ÛŒØ§ÙØªÛŒ"""
    global enemy_id, enemy_name, enemy_mode
    
    if 'message' not in update:
        return
    
    msg = update['message']
    chat_id = msg['chat']['id']
    text = msg.get('text', '').strip()
    user_id = msg['from']['id']
    username = msg['from'].get('username', '')
    first_name = msg['from'].get('first_name', 'Ú©Ø§Ø±Ø¨Ø±')
    message_id = msg['message_id']
    
    print(f"ğŸ“¨ Ù¾ÛŒØ§Ù… Ø§Ø² {first_name}: {text}")
    
    # Ø¯Ø³ØªÙˆØ± /start
    if text == '/start':
        send_message(chat_id,
            "ğŸ¤– <b>Ø³Ù„Ù Ø¨Ø§Øª ÙØ§Ø±Ø³ÛŒ</b>\n\n"
            "ğŸ”¥ <b>ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:</b>\n"
            "â€¢ ØªØ§ÛŒÙ… Ø§ÛŒØ±Ø§Ù† Ø®ÙˆØ¯Ú©Ø§Ø±\n"
            "â€¢ Ù¾Ø§Ø³Ø® Ø®ÙˆØ¯Ú©Ø§Ø±\n"
            "â€¢ Ø­Ø§Ù„Øª Ø¯Ø´Ù…Ù†\n"
            "â€¢ 24/7 Ø¢Ù†Ù„Ø§ÛŒÙ†\n\n"
            "ğŸ¯ <b>Ø¯Ø³ØªÙˆØ±Ø§Øª:</b>\n"
            "â€¢ ØªÙ†Ø¸ÛŒÙ… Ø¯Ø´Ù…Ù† (Ø¨Ø§ Ø±ÛŒÙ¾Ù„Ø§ÛŒ)\n"
            "â€¢ Ø®Ø§Ù…ÙˆØ´ Ø¯Ø´Ù…Ù†\n"
            "â€¢ ÙˆØ¶Ø¹ÛŒØª\n"
            "â€¢ Ø±Ø§Ù‡Ù†Ù…Ø§"
        )
        return
    
    # Ø¯Ø³ØªÙˆØ± Ø±Ø§Ù‡Ù†Ù…Ø§
    elif text == '/help':
        send_message(chat_id,
            "ğŸ“– <b>Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø³Ù„Ù Ø¨Ø§Øª:</b>\n\n"
            "ğŸ¯ <b>Ù†Ø­ÙˆÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡:</b>\n"
            "1. Ø±ÙˆÛŒ Ù¾ÛŒØ§Ù… Ú©Ø§Ø±Ø¨Ø± Ø±ÛŒÙ¾Ù„Ø§ÛŒ Ú©Ù†ÛŒØ¯\n"
            "2. Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯: ØªÙ†Ø¸ÛŒÙ… Ø¯Ø´Ù…Ù†\n"
            "3. Ø§Ø² Ø§ÛŒÙ† Ø¨Ù‡ Ø¨Ø¹Ø¯ Ø¨Ù‡Ø´ ÙØ­Ø´ Ù…ÛŒâ€ŒØ¯Ù‡\n\n"
            "âš™ï¸ <b>Ø¯Ø³ØªÙˆØ±Ø§Øª:</b>\n"
            "/start - Ø´Ø±ÙˆØ¹ Ø¨Ø§Øª\n"
            "/help - Ø§ÛŒÙ† Ø±Ø§Ù‡Ù†Ù…Ø§\n"
            "/status - ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Øª\n"
            "/time - Ø²Ù…Ø§Ù† Ø§ÛŒØ±Ø§Ù†"
        )
        return
    
    # Ø¯Ø³ØªÙˆØ± ÙˆØ¶Ø¹ÛŒØª
    elif text == '/status':
        status_msg = f"""
ğŸ“Š <b>ÙˆØ¶Ø¹ÛŒØª Ø³Ù„Ù Ø¨Ø§Øª:</b>

ğŸ”¥ Ø­Ø§Ù„Øª Ø¯Ø´Ù…Ù†: {'âœ… ÙØ¹Ø§Ù„' if enemy_mode else 'â­• ØºÛŒØ±ÙØ¹Ø§Ù„'}
ğŸ‘¤ Ø¯Ø´Ù…Ù† ÙØ¹Ù„ÛŒ: {enemy_name if enemy_mode else 'Ù†Ø¯Ø§Ø±Ø¯'}
ğŸ•’ Ø²Ù…Ø§Ù†: {datetime.now().strftime('%H:%M:%S')}
ğŸ“¡ ÙˆØ¶Ø¹ÛŒØª: Ø¢Ù†Ù„Ø§ÛŒÙ†
        """
        send_message(chat_id, status_msg)
        return
    
    # Ø¯Ø³ØªÙˆØ± Ø²Ù…Ø§Ù†
    elif text == '/time':
        now = datetime.now()
        time_str = now.strftime('%Y/%m/%d - %H:%M:%S')
        send_message(chat_id, f"ğŸ•’ <b>Ø²Ù…Ø§Ù† Ø§ÛŒØ±Ø§Ù†:</b> {time_str}")
        return
    
    # ØªÙ†Ø¸ÛŒÙ… Ø¯Ø´Ù…Ù†
    if text == 'ØªÙ†Ø¸ÛŒÙ… Ø¯Ø´Ù…Ù†' and 'reply_to_message' in msg:
        target_msg = msg['reply_to_message']
        target_user = target_msg['from']
        
        enemy_id = target_user['id']
        enemy_name = target_user.get('first_name', 'Ú©Ø§Ø±Ø¨Ø±')
        enemy_mode = True
        
        send_message(chat_id,
            f"âœ… <b>Ø¯Ø´Ù…Ù† ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯!</b>\n\n"
            f"ğŸ‘¤ Ù†Ø§Ù…: {enemy_name}\n"
            f"ğŸ†” ID: {enemy_id}\n"
            f"ğŸ”¥ Ø­Ø§Ù„Øª: ÙØ¹Ø§Ù„\n\n"
            f"Ø§Ø² Ø§ÛŒÙ† Ø¨Ù‡ Ø¨Ø¹Ø¯ Ø¨Ù‡ Ù‡Ù…Ù‡ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ† Ú©Ø§Ø±Ø¨Ø± ÙØ­Ø´ Ù…ÛŒâ€ŒØ¯Ù‡Ù…!"
        )
        print(f"ğŸ¯ Ø¯Ø´Ù…Ù† ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯: {enemy_name} (ID: {enemy_id})")
        return
    
    # Ø®Ø§Ù…ÙˆØ´ Ú©Ø±Ø¯Ù† Ø¯Ø´Ù…Ù†
    elif text == 'Ø®Ø§Ù…ÙˆØ´ Ø¯Ø´Ù…Ù†':
        enemy_mode = False
        send_message(chat_id, "âœ… Ø­Ø§Ù„Øª Ø¯Ø´Ù…Ù† ØºÛŒØ±ÙØ¹Ø§Ù„ Ø´Ø¯")
        print("ğŸŸ¢ Ø­Ø§Ù„Øª Ø¯Ø´Ù…Ù† ØºÛŒØ±ÙØ¹Ø§Ù„ Ø´Ø¯")
        return
    
    # Ø§Ú¯Ø± Ø¯Ø´Ù…Ù† Ù¾ÛŒØ§Ù… Ø¯Ø§Ø¯
    if enemy_mode and enemy_id and user_id == enemy_id:
        bad_word = random.choice(BAD_WORDS)
        emoji = random.choice(["ğŸ”¥", "ğŸ’¢", "âš¡", "ğŸ‘Š", "ğŸ˜¡"])
        
        send_message(chat_id, f"{emoji} <b>{bad_word}</b> {emoji}", reply_to=message_id)
        print(f"ğŸ”¥ Ø¨Ù‡ Ø¯Ø´Ù…Ù† Ù¾Ø§Ø³Ø® Ø¯Ø§Ø¯Ù…: {bad_word}")
        return
    
    # Ù¾Ø§Ø³Ø® Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù‡ Ù¾ÛŒØ§Ù… Ø®ØµÙˆØµÛŒ
    if msg['chat']['type'] == 'private':
        # ØªØ£Ø®ÛŒØ± Ø±Ù†Ø¯ÙˆÙ… 1-5 Ø«Ø§Ù†ÛŒÙ‡
        time.sleep(random.uniform(1, 5))
        
        send_message(chat_id,
            "ğŸ”ºØ¨Ù‡ Ø¯Ù„ÛŒÙ„ Ù…Ø´ØºÙ„Ù‡ Ú©Ø§Ø±ÛŒ Ùˆ Ù‚Ø·Ø¹ÛŒ Ù…Ú©Ø±Ø± Ø§ÛŒÙ†ØªØ±Ù†Øª Ù…Ù…Ú©Ù†Ù‡ Ú©Ù…ÛŒ Ø¨Ø§ ØªØ§Ø®ÛŒØ± Ø¬ÙˆØ§Ø¨ Ø¨Ú¯ÛŒØ±ÛŒØ¯"
        )
        print(f"ğŸ¤– Ù¾Ø§Ø³Ø® Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù‡ {first_name}")

def main():
    """ØªØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ Ø§Ø¬Ø±Ø§"""
    print("=" * 50)
    print("ğŸš€ Ø³Ù„Ù Ø¨Ø§Øª ÙØ§Ø±Ø³ÛŒ - Ù†Ø³Ø®Ù‡ GitHub")
    print(f"ğŸ¤– ØªÙˆÚ©Ù†: {TOKEN[:10]}...")
    print("â° Ø´Ø±ÙˆØ¹: " + datetime.now().strftime('%Y/%m/%d %H:%M:%S'))
    print("=" * 50)
    
    offset = 0
    
    while True:
        try:
            # Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
            url = f"https://api.telegram.org/bot{TOKEN}/getUpdates"
            params = {
                'offset': offset,
                'timeout': 30,
                'allowed_updates': ['message']
            }
            
            response = requests.get(url, params=params, timeout=35)
            
            if response.status_code == 200:
                data = response.json()
                
                if data.get('ok'):
                    for update in data.get('result', []):
                        offset = update['update_id'] + 1
                        process_update(update)
            
            # Ù‡Ø± Ø«Ø§Ù†ÛŒÙ‡ Ú†Ú© Ú©Ù†
            time.sleep(1)
            
        except KeyboardInterrupt:
            print("\n\nğŸ›‘ Ø³Ù„Ù Ø¨Ø§Øª Ù…ØªÙˆÙ‚Ù Ø´Ø¯.")
            break
        except Exception as e:
            print(f"âš ï¸ Ø®Ø·Ø§: {e}")
            time.sleep(5)

if __name__ == "__main__":
    main()
